<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="JS," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="TCP/IP详解学习笔记   这位仁兄写得太好了http://blog.csdn.net/goodboy1881/category/204448.aspxTCP/IP详解学习笔记(13)-TCP坚持定时器，TCP保活定时器TCP/IP详解学习笔记(12)-TCP的超时与重传TCP/IP详解学习笔记(11)-TCP交互数据流，成块数据流
TCP/IP详解学习笔记(1)-基本概念为什么会有TCP/IP">
<meta property="og:type" content="article">
<meta property="og:title" content="TCP/IP🌿">
<meta property="og:url" content="https://menggeniu.github.io/2016/03/25/14/index.html">
<meta property="og:site_name" content="NNNの博客">
<meta property="og:description" content="TCP/IP详解学习笔记   这位仁兄写得太好了http://blog.csdn.net/goodboy1881/category/204448.aspxTCP/IP详解学习笔记(13)-TCP坚持定时器，TCP保活定时器TCP/IP详解学习笔记(12)-TCP的超时与重传TCP/IP详解学习笔记(11)-TCP交互数据流，成块数据流
TCP/IP详解学习笔记(1)-基本概念为什么会有TCP/IP">
<meta property="og:updated_time" content="2016-11-19T02:16:52.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TCP/IP🌿">
<meta name="twitter:description" content="TCP/IP详解学习笔记   这位仁兄写得太好了http://blog.csdn.net/goodboy1881/category/204448.aspxTCP/IP详解学习笔记(13)-TCP坚持定时器，TCP保活定时器TCP/IP详解学习笔记(12)-TCP的超时与重传TCP/IP详解学习笔记(11)-TCP交互数据流，成块数据流
TCP/IP详解学习笔记(1)-基本概念为什么会有TCP/IP">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> TCP/IP🌿 | NNNの博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">NNNの博客</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">前端小菜鸟</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                TCP/IP🌿
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-25T23:00:06+08:00" content="2016-03-25">
              2016-03-25
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/03/25/14/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/03/25/14/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h6 id="TCP-IP详解学习笔记-这位仁兄写得太好了"><a href="#TCP-IP详解学习笔记-这位仁兄写得太好了" class="headerlink" title="TCP/IP详解学习笔记   这位仁兄写得太好了"></a>TCP/IP详解学习笔记   这位仁兄写得太好了<br></h6><p><a href="http://blog.csdn.net/goodboy1881/category/204448.aspx" target="_blank" rel="external">http://blog.csdn.net/goodboy1881/category/204448.aspx</a><br><br>TCP/IP详解学习笔记(13)-TCP坚持定时器，TCP保活定时器<br><br>TCP/IP详解学习笔记(12)-TCP的超时与重传<br><br>TCP/IP详解学习笔记(11)-TCP交互数据流，成块数据流<br></p>
<h3 id="TCP-IP详解学习笔记-1-基本概念"><a href="#TCP-IP详解学习笔记-1-基本概念" class="headerlink" title="TCP/IP详解学习笔记(1)-基本概念"></a>TCP/IP详解学习笔记(1)-基本概念</h3><h4 id="为什么会有TCP-IP协议"><a href="#为什么会有TCP-IP协议" class="headerlink" title="为什么会有TCP/IP协议"></a>为什么会有TCP/IP协议</h4><p>在世界上各地，各种各样的电脑运行着各自不同的操作系统为大家服务，这些电脑在表达同一种信息的时候所使用的方法是千差万别。就好像圣经中上帝打乱了各地人的口音，让他们无法合作一样。计算机使用者意识到，计算机只是单兵作战并不会发挥太大的作用。只有把它们联合起来，电脑才会发挥出它最大的潜力。于是人们就想方设法的用电线把电脑连接到了一起。<br><br>但是简单的连到一起是远远不够的，就好像语言不同的两个人互相见了面，完全不能交流信息。因而他们需要定义一些共通的东西来进行交流，TCP/IP就是为此而生。TCP/IP不是一个协议，而是一个协议族的统称。里面包括了IP协议，IMCP协议，TCP协议，以及我们更加熟悉的http、ftp、pop3协议等等。电脑有了这些，就好像学会了外语一样，就可以和其他的计算机终端做自由的交流了。<br></p>
<h4 id="TCP-IP协议分层"><a href="#TCP-IP协议分层" class="headerlink" title="TCP/IP协议分层"></a>TCP/IP协议分层</h4><p>提到协议分层，我们很容易联想到ISO-OSI的七层协议经典架构，但是TCP/IP协议族的结构则稍有不同。如图所示 <br><br>TCP/IP协议族按照层次由上到下，层层包装。最上面的就是应用层了，这里面有http，ftp,等等我们熟悉的协议。而第二层则是传输层，著名的TCP和UDP协议就在这个层次（不要告诉我你没用过udp玩星际）。第三层是网络层，IP协议就在这里，它负责对数据加上IP地址和其他的数据（后面会讲到）以确定传输的目标。第四层是叫数据链路层，这个层次为待传送的数据加入一个以太网协议头，并进行CRC编码，为最后的数据传输做准备。再往下则是硬件层次了，负责网络的传输，这个层次的定义包括网线的制式，网卡的定义等等（这些我们就不用关心了，我们也不做网卡），所以有些书并不把这个层次放在tcp/ip协议族里面，因为它几乎和tcp/ip协议的编写者没有任何的关系。发送协议的主机从上自下将数据按照协议封装，而接收数据的主机则按照协议从得到的数据包解开，最后拿到需要的数据。这种结构非常有栈的味道，所以某些文章也把tcp/ip协议族称为tcp/ip协议栈。<br></p>
<h4 id="一些基本的常识"><a href="#一些基本的常识" class="headerlink" title="一些基本的常识"></a>一些基本的常识</h4><p>在学习协议之前，我们应该具备一些基本知识。<br></p>
<h5 id="互联网地址-ip地址"><a href="#互联网地址-ip地址" class="headerlink" title="互联网地址(ip地址)"></a>互联网地址(ip地址)</h5><p>网络上每一个节点都必须有一个独立的Internet地址（也叫做IP地址）。现在，通常使用的IP地址是一个32bit的数字，也就是我们常说的IPv4标准，这32bit的数字分成四组，也就是常见的255.255.255.255的样式。IPv4标准上，地址被分为五类，我们常用的是B类地址。具体的分类请参考其他文档。需要注意的是IP地址是网络号+主机号的组合，这非常重要。<br></p>
<h5 id="域名系统"><a href="#域名系统" class="headerlink" title="域名系统"></a>域名系统</h5><p>域名系统是一个分布的数据库，它提供将主机名（就是网址啦）转换成IP地址的服务。<br></p>
<h5 id="RFC"><a href="#RFC" class="headerlink" title="RFC"></a>RFC</h5><p>RFC是什么？RFC就是tcp/ip协议的标准文档，在这里我们可以看到RFC那长长的定义列表，现在它一共有4000多个协议的定义，当然，我们所要学习的，也就是那么十几个协议而已。 <br></p>
<h5 id="端口号-port"><a href="#端口号-port" class="headerlink" title="端口号(port)"></a>端口号(port)</h5><p>注意，这个号码是用在TCP，UDP上的一个逻辑号码，并不是一个硬件端口，我们平时说把某某端口封掉了，也只是在IP层次把带有这个号码的IP包给过滤掉了而已。<br></p>
<h5 id="应用编程接口"><a href="#应用编程接口" class="headerlink" title="应用编程接口"></a>应用编程接口</h5><p>现在常用的编程接口有socket和TLI。而前面的有时候也叫做“Berkeley socket”，可见Berkeley对于网络的发展有多大的贡献。<br></p>
<h3 id="TCP-IP详解学习笔记-2-数据链路层"><a href="#TCP-IP详解学习笔记-2-数据链路层" class="headerlink" title="TCP/IP详解学习笔记(2)-数据链路层"></a>TCP/IP详解学习笔记(2)-数据链路层</h3><p>数据链路层有三个目的：<br><br>1.为IP模块发送和 接收IP数据报。<br><br>2.为ARP模块发送ARP请求和接收ARP应答。<br><br>3.为RARP发送RARP请 求和接收RARP应答<br><br>ip大家都听说过。至于ARP和RARP，ARP叫做地址解析协议，是用IP地址换MAC地址的一种协议，而RARP则叫做逆地址解析协议，在tcp/ip协议的后面章节会介绍它们（在局域网里面用ARP协议可以很容易的搞瘫痪网络哦）<br><br>数据链路层的协议还是很多的，有我们最常用的以太网（就是平时我们用的网卡）协议，也有不太常见的令牌环，还有FDDI，当然，还有国内现在相当普及的PPP协议（就是adsl宽带），以及一个loopback协议。<br><br>联系linux里面的ifconfig -a命令，这个命令通常会得到如下的结果<br></p>
<pre><code>eth0 Link encap:Ethernet HWaddr 00:01:4A:03:5B:ED
inet addr:192.168.11.2 Bcast:192.168.11.255 Mask:255.255.255.0
inet6 addr: fe80::201:4aff:fe03:5bed/64 Scope:Link
UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1
RX packets:2819 errors:0 dropped:0 overruns:0 frame:0
TX packets:76 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:1000
RX bytes:241609 (235.9 KiB) TX bytes:9596 (9.3 KiB)

lo Link encap:Local Loopback
inet addr:127.0.0.1 Mask:255.0.0.0
inet6 addr: ::1/128 Scope:Host
UP LOOPBACK RUNNING MTU:16436 Metric:1
RX packets:2713 errors:0 dropped:0 overruns:0 frame:0
TX packets:2713 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:3516032 (3.3 MiB) TX bytes:3516032 (3.3 MiB)
</code></pre><p>其中，eth0就是以太网接口，而lo则是loopback接口。这也说明这个主机在网络链路层上至少支持loopback协议和以太网协议。<br><br>以太网（Ether-net）的定是指数字设备公司（ Digital Equipment Corp.）、英特尔公司（Intel Corp.）和Xerox公司在1982年联合公布的一个标准，这个标准里面使用了一种称作CSMA/CD的接入方法。而IEEE802提供的标准集802.3(还有一部分定义到了802.2中)也提供了一个CSMA/CD的标准。这两个标准稍有不同，TCP/IP协议对这种情况的处理方式如下:<br></p>
<p>1.以太网的IP数据报封装在RFC894中定义，而IEEE802网络的IP数据报封装在RFC1042中定义。<br><br>2.一台主机一定要能发送和接收RFC894定义的数据报。<br><br>3.一台主机可以接收RFC894和RFC1042的封装格式的混合数据报。<br><br>4.一台主机也许能够发送RFC1042数据报。。如果主机能同时发送两种类型的分组数 据，那么发送的分组必须是可以设置的，而且默认条件下必须是RFC 894分组。<br></p>
<h6 id="可见，RFC1042在TCP-IP里面处于一个配角的地位。这两种不同的数据报格式请参考教材。"><a href="#可见，RFC1042在TCP-IP里面处于一个配角的地位。这两种不同的数据报格式请参考教材。" class="headerlink" title="可见，RFC1042在TCP/IP里面处于一个配角的地位。这两种不同的数据报格式请参考教材。"></a>可见，RFC1042在TCP/IP里面处于一个配角的地位。这两种不同的数据报格式请参考教材。</h6><p>ppp(点对点协议)是从SLIP的替代品。他们都提供了一种低速接入的解决方案。而每一种数据链路层协议，都有一个MTU（最大传输单元）定义，在这个定义下面，如果IP数据报过大，则要进行分片(fragmentation)，使得每片都小于MTU，注意PPP的MTU并不是一个物理定义，而是指一个逻辑定义（个人认为就是用程序控制）。可以用netstat来打印出MTU的结果，比如键入netstat -in<br><br><code>Kernel Interface table
Iface       MTU Met    RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg
eth0       1500   0     1774      0      0      0      587      0      0      0 BMRU
lo        16436   0     2667      0      0      0     2667      0      0      0 LRU</code><br><br>就可以观察到eth0的MTU是1500。而lo（环回接口）的MTU则是16436。<br><br>最后说说那个环回接口（loopback）。平时我们用127.0.0.1来尝试自己的机器服务器好使不好使。走的就是这个loopback接口。对于环回接口，有如下三点值得注意:<br>1.传给环回地址（一般是127.0.0.1）的任何数据均作为I P输入。<br><br>2.传给广播地址或多播地址的数据报复制一份传给环回接口，然后送到以太网上。这是 因为广播传送和多播传送的定义包含主机本身。<br><br>3.任何传给该主机IP地址的数据均送到环回接口。<br><br>这一章还是很简单的，一般作为了解知识也就足够了，没必要抠的那么详细。<br></p>
<h3 id="TCP-IP详解之IP协议ARP协议和RARP协议"><a href="#TCP-IP详解之IP协议ARP协议和RARP协议" class="headerlink" title="TCP/IP详解之IP协议ARP协议和RARP协议"></a>TCP/IP详解之IP协议ARP协议和RARP协议</h3><p>把这三个协议放到一起学习是因为这三个协议处于同一层，ARP协议用来找到目标主机的Ethernet网卡Mac地址，IP则承载要发送的消息。数据链路层可以从ARP得到数据的传送信息，而从IP得到要传输的数据信息。<br></p>
<h4 id="1-IP协议"><a href="#1-IP协议" class="headerlink" title="1.IP协议"></a>1.IP协议</h4><p>IP协议是TCP/IP协议的核心，所有的TCP，UDP，IMCP，IGCP的数据都以IP数据格式传输。要注意的是，IP不是可靠的协议，这是说，IP协议没有提供一种数据未传达以后的处理机制–这被认为是上层协议–TCP或UDP要做的事情。所以这也就出现了TCP是一个可靠的协议，而UDP就没有那么可靠的区别。这是后话，暂且不提<br></p>
<h5 id="1-1-IP协议头"><a href="#1-1-IP协议头" class="headerlink" title="1.1.IP协议头"></a>1.1.IP协议头</h5><p>挨个解释它是教科书的活计，我感兴趣的只是那八位的TTL字段，还记得这个字段是做什么的么?这个字段规定该数据包在穿过多少个路由之后才会被抛弃(这里就体现出来IP协议包的不可靠性，它不保证数据被送达)，某个ip数据包每穿过一个路由器，该数据包的TTL数值就会减少1，当该数据包的TTL成为零，它就会被自动抛弃。这个字段的最大值也就是255，也就是说一个协议包也就在路由器里面穿行255次就会被抛弃了，根据系统的不同，这个数字也不一样，一般是32或者是64，Tracerouter这个工具就是用这个原理工作的，tranceroute的-m选项要求最大值是255，也就是因为这个TTL在IP协议里面只有8bit。<br><br>现在的ip版本号是4，所以也称作IPv4。现在还有IPv6，而且运用也越来越广泛了。<br></p>
<h5 id="1-2-IP路由选择"><a href="#1-2-IP路由选择" class="headerlink" title="1.2.IP路由选择"></a>1.2.IP路由选择</h5><p>当一个IP数据包准备好了的时候，IP数据包(或者说是路由器)是如何将数据包送到目的地的呢?它是怎么选择一个合适的路径来”送货”的呢?<br><br>最特殊的情况是目的主机和主机直连，那么主机根本不用寻找路由，直接把数据传递过去就可以了。至于是怎么直接传递的，这就要靠ARP协议了，后面会讲到。<br><br>稍微一般一点的情况是，主机通过若干个路由器(router)和目的主机连接。那么路由器就要通过ip包的信息来为ip包寻找到一个合适的目标来进行传递，比如合适的主机，或者合适的路由。路由器或者主机将会用如下的方式来处理某一个IP数据包<br><br>如果IP数据包的TTL(生命周期)以到，则该IP数据包就被抛弃。<br><br>搜索路由表，优先搜索匹配主机，如果能找到和IP地址完全一致的目标主机，则将该包发向目标主机<br><br>搜索路由表，如果匹配主机失败，则匹配同子网的路由器，这需要“子网掩码(1.3.)”的协助。如果找到路由器，则将该包发向路由器。<br><br>搜索路由表，如果匹配同子网路由器失败，则匹配同网号(第一章有讲解)路由器，如果找到路由器，则将该包发向路由器。<br><br>搜索陆游表，如果以上都失败了，就搜索默认路由，如果默认路由存在，则发包<br><br>如果都失败了，就丢掉这个包。<br><br>这再一次证明了，ip包是不可靠的。因为它不保证送达。<br></p>
<h5 id="1-3-子网寻址"><a href="#1-3-子网寻址" class="headerlink" title="1.3.子网寻址"></a>1.3.子网寻址</h5><p>IP地址的定义是网络号+主机号。但是现在所有的主机都要求子网编址，也就是说，把主机号在细分成子网号+主机号。最终一个IP地址就成为 网络号码+子网号+主机号。例如一个B类地址：210.30.109.134。一般情况下，这个IP地址的红色部分就是网络号，而蓝色部分就是子网号，绿色部分就是主机号。至于有多少位代表子网号这个问题上，这没有一个硬性的规定，取而代之的则是子网掩码，校园网相信大多数人都用过，在校园网的设定里面有一个255.255.255.0的东西，这就是子网掩码。子网掩码是由32bit的二进制数字序列,形式为是一连串的1和一连串的0，例如：255.255.255.0(二进制就是11111111.11111111.11111111.00000000)对于刚才的那个B类地址，因为210.30是网络号，那么后面的109.134就是子网号和主机号的组合，又因为子网掩码只有后八bit为0，所以主机号就是IP地址的后八个bit，就是134，而剩下的就是子网号码–109。<br></p>
<h4 id="2-ARP协议"><a href="#2-ARP协议" class="headerlink" title="2. ARP协议"></a>2. ARP协议</h4><p>还记得数据链路层的以太网的协议中，每一个数据包都有一个MAC地址头么?我们知道每一块以太网卡都有一个MAC地址，这个地址是唯一的，那么IP包是如何知道这个MAC地址的?这就是ARP协议的工作。<br><br>ARP(地址解析)协议是一种解析协议，本来主机是完全不知道这个IP对应的是哪个主机的哪个接口，当主机要发送一个IP包的时候，会首先查一下自己的ARP高速缓存(就是一个IP-MAC地址对应表缓存)，如果查询的IP-MAC值对不存在，那么主机就向网络发送一个ARP协议广播包，这个广播包里面就有待查询的IP地址，而直接收到这份广播的包的所有主机都会查询自己的IP地址，如果收到广播包的某一个主机发现自己符合条件，那么就准备好一个包含自己的MAC地址的ARP包传送给发送ARP广播的主机，而广播主机拿到ARP包后会更新自己的ARP缓存(就是存放IP-MAC对应表的地方)。发送广播的主机就会用新的ARP缓存数据准备好数据链路层的的数据包发送工作。<br><br>一个典型的arp缓存信息如下，在任意一个系统里面用“arp -a”命令:<br></p>
<pre><code>Interface: 192.168.11.3 --- 0x2&lt;br&gt;
Internet Address Physical Address Type&lt;br&gt;
</code></pre><p>　　192.168.11.1 00-0d-0b-43-a0-2e dynamic<br><br>　　192.168.11.2 00-01-4a-03-5b-ed dynamic<br><br>都会得到这样的结果。<br><br>这样的高速缓存是有时限的，一般是20分钟(伯克利系统的衍生系统)。<br></p>
<h3 id="TCP-IP详解学习笔记-4-ICMP协议，ping和Traceroute"><a href="#TCP-IP详解学习笔记-4-ICMP协议，ping和Traceroute" class="headerlink" title="TCP/IP详解学习笔记(4)-ICMP协议，ping和Traceroute"></a>TCP/IP详解学习笔记(4)-ICMP协议，ping和Traceroute</h3><h4 id="1-IMCP协议介绍"><a href="#1-IMCP协议介绍" class="headerlink" title="1.IMCP协议介绍"></a>1.IMCP协议介绍</h4><p>前面讲到了，IP协议并不是一个可靠的协议，它不保证数据被送达，那么，自然的，保证数据送达的工作应该由其他的模块来完成。其中一个重要的模块就是ICMP(网络控制报文)协议。<br><br>当传送IP数据包发生错误－－比如主机不可达，路由不可达等等，ICMP协议将会把错误信息封包，然后传送回给主机。给主机一个处理错误的机会，这 也就是为什么说建立在IP层以上的协议是可能做到安全的原因。ICMP数据包由8bit的错误类型和8bit的代码和16bit的校验和组成。而前 16bit就组成了ICMP所要传递的信息。书上的图6－3清楚的给出了错误类型和代码的组合代表的意思。<br><br>尽管在大多数情况下，错误的包传送应该给出ICMP报文，但是在特殊情况下，是不产生ICMP错误报文的。如下<br><br>1.ICMP差错报文不会产生ICMP差错报文（出IMCP查询报文）（防止IMCP的无限产生和传送）<br><br>2.目的地址是广播地址或多播地址的IP数据报。<br><br>3.作为链路层广播的数据报。<br><br>4.不是IP分片的第一片。<br><br>5.源地址不是单个主机的数据报。这就是说，源地址不能为零地址、环回地址、广播地 址或多播地址。<br><br>虽然里面的一些规定现在还不是很明白，但是所有的这一切规定，都是为了防止产生ICMP报文的无限传播而定义的。<br><br>ICMP协议大致分为两类，一种是查询报文，一种是差错报文。其中查询报文有以下几种用途:<br><br>1.ping查询（不要告诉我你不知道ping程序）<br><br>2.子网掩码查询（用于无盘工作站在初始化自身的时候初始化子网掩码）<br><br>3.时间戳查询（可以用来同步时间） <br><br>而差错报文则产生在数据传送发生错误的时候。就不赘述了。<br></p>
<h4 id="2-ICMP的应用–ping"><a href="#2-ICMP的应用–ping" class="headerlink" title="2.ICMP的应用–ping"></a>2.ICMP的应用–ping</h4><p>ping可以说是ICMP的最著名的应用，当我们某一个网站上不去的时候。通常会ping一下这个网站。ping会回显出一些有用的信息。一般的信息如下:<br><br>Reply from 10.4.24.1: bytes=32 time<1ms ttl="255<br"><br>Reply from 10.4.24.1: bytes=32 time<1ms ttl="255<br"><br>Reply from 10.4.24.1: bytes=32 time<1ms ttl="255<br"><br>Reply from 10.4.24.1: bytes=32 time<1ms ttl="255<br"><br>Ping statistics for 10.4.24.1:<br><br>    Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),<br><br>Approximate round trip times in milli-seconds:<br><br>    Minimum = 0ms, Maximum = 0ms, Average = 0ms<br><br>ping这个单词源自声纳定位，而这个程序的作用也确实如此，它利用ICMP协议包来侦测另一个主机是否可达。原理是用类型码为0的ICMP发请 求，受到请求的主机则用类型码为8的ICMP回应。ping程序来计算间隔时间，并计算有多少个包被送达。用户就可以判断网络大致的情况。我们可以看到， ping给出来了传送的时间和TTL的数据。我给的例子不太好，因为走的路由少，有兴趣地可以ping一下国外的网站比如sf.net，就可以观察到一些 丢包的现象，而程序运行的时间也会更加的长。<br><br>ping还给我们一个看主机到目的主机的路由的机会。这是因为，ICMP的ping请求数据报在每经过一个路由器的时候，路由器都会把自己的ip放到该数 据报中。而目的主机则会把这个ip列表复制到回应icmp数据包中发回给主机。但是，无论如何，ip头所能纪录的路由列表是非常的有限。如果要观察路由， 我们还是需要使用更好的工具，就是要讲到的Traceroute(windows下面的名字叫做tracert)。<br></1ms></1ms></1ms></1ms></p>
<h4 id="3-ICMP的应用–Traceroute"><a href="#3-ICMP的应用–Traceroute" class="headerlink" title="3.ICMP的应用–Traceroute"></a>3.ICMP的应用–Traceroute</h4><p>Traceroute是用来侦测主机到目的主机之间所经路由情况的重要工具，也是最便利的工具。前面说到，尽管ping工具也可以进行侦测，但是，因为ip头的限制，ping不能完全的记录下所经过的路由器。所以Traceroute正好就填补了这个缺憾。<br><br>Traceroute的原理是非常非常的有意思，它受到目的主机的IP后，首先给目的主机发送一个TTL=1（还记得TTL是什么吗？）的UDP(后面就 知道UDP是什么了)数据包，而经过的第一个路由器收到这个数据包以后，就自动把TTL减1，而TTL变为0以后，路由器就把这个包给抛弃了，并同时产生 一个主机不可达的ICMP数据报给主机。主机收到这个数据报以后再发一个TTL=2的UDP数据报给目的主机，然后刺激第二个路由器给主机发ICMP数据 报。如此往复直到到达目的主机。这样，traceroute就拿到了所有的路由器ip。从而避开了ip头只能记录有限路由IP的问题。<br><br>有人要问，我怎么知道UDP到没到达目的主机呢？这就涉及一个技巧的问题，TCP和UDP协议有一个端口号定义，而普通的网络程序只监控少数的几个号码较 小的端口，比如说80,比如说23,等等。而traceroute发送的是端口号&gt;30000(真变态)的UDP报，所以到达目的主机的时候，目的 主机只能发送一个端口不可达的ICMP数据报给主机。主机接到这个报告以后就知道，主机到了，所以，说Traceroute是一个骗子一点也不为过:)<br><br>Traceroute程序里面提供了一些很有用的选项，甚至包含了IP选路的选项，请察看man文档来了解这些，这里就不赘述了。<br></p>
<h3 id="TCP-IP详解学习笔记-5-IP选路，动态选路，和一些细节"><a href="#TCP-IP详解学习笔记-5-IP选路，动态选路，和一些细节" class="headerlink" title="TCP/IP详解学习笔记(5)-IP选路，动态选路，和一些细节"></a>TCP/IP详解学习笔记(5)-IP选路，动态选路，和一些细节</h3><h4 id="1-静态IP选路"><a href="#1-静态IP选路" class="headerlink" title="1.静态IP选路"></a>1.静态IP选路</h4><h5 id="1-1-一个简单的路由表"><a href="#1-1-一个简单的路由表" class="headerlink" title="1.1.一个简单的路由表"></a>1.1.一个简单的路由表</h5><p>选路是IP层最重要的一个功能之一。前面的部分已经简单的讲过路由器是通过何种规则来根据IP数据包的IP地址来选择路由。这里就不重复了。首先来看看一个简单的系统路由表。<br><br>Destination     Gateway         Genmask         Flags Metric Ref    Use Iface<br><br>192.168.11.0    <em>               255.255.255.0   U     0      0        0 eth0<br><br>169.254.0.0     </em>               255.255.0.0     U     0      0        0 eth0<br><br>default         192.168.11.1    0.0.0.0         UG    0      0        0 eth0<br><br>对于一个给定的路由器，可以打印出五种不同的flag。<br><br>1.U表明该路由可用。<br><br>2.G表明该路由是到一个网关。如果没有这个标志，说明和Destination是直连的，而相应的Gateway应该直接给出Destination的地址。<br><br>3.H表明该路由是到一个主机，如果没有该标志，说明Destination是一个网络，换句话说Destination就应该写成一个网络号和子网号的组合，而不包括主机号(主机号码处为0)，例如 192.168.11.0<br><br>4.D表明该路由是为重定向报文创建的<br><br>5.M该路由已经被重定向报文修改 <br><br>U没啥可说的，G说明这是一个网关，如果你要发数据给Destination，IP头应该写Destination的IP地址，而数据链路层的MAC地址就应该是GateWay的Mac地址了；反之，如果没有G标志，那么数据链路层和IP层的地址应该是对应的。H说明了Destination的性质，如果是H的，则说明该地址是一个完整的地址，既有网络号又有主机号，那么再匹配的时候就既要匹配网络号，又要匹配主机号；反之，Destination就代表一个网络，在匹配的时候只要匹配一下网络号就可以了。<br><br>这样，IP选路的方式就可以更加具体化了。如下<br><br>1.首先用IP地址来匹配那些带H标志的DestinationIP地址。<br><br>2.如果1失败就匹配那些网络地址。<br><br>3.如果2失败就发送到Default网关 <br><br>顺便提一下那个GenMask（还记得子网掩码么），它指定了目的地址的子网号，例如第一条的子网就是11。<br></p>
<h5 id="1-2-其他有关路由表的知识"><a href="#1-2-其他有关路由表的知识" class="headerlink" title="1.2.其他有关路由表的知识"></a>1.2.其他有关路由表的知识</h5><p>一般，我们在配置好一个网络接口的时候，一个路由就被直接创建好了。当然我们也可以手动添加路由。用route add命令就可以了。<br><br>而当一个IP包在某一个路由器的时候发现没有路由可走，那么该路由器就会给源主机发送“主机不可达”或者“网络不可达”的ICMP包来报错。<br><br>注意，一般的操作系统默认是没有路由功能的，这需要自己配置。这些历史原因就不细说了。<br></p>
<h5 id="1-3-ICMP的IP重定向报文和路由发现报文"><a href="#1-3-ICMP的IP重定向报文和路由发现报文" class="headerlink" title="1.3.ICMP的IP重定向报文和路由发现报文"></a>1.3.ICMP的IP重定向报文和路由发现报文</h5><p>当IP包在某一个地方转向的时候，都回给发送IP报的源主机一个ICMP重定向报文，而源主机就可以利用这个信息来更新自己的路由表，这样，随着网络通信的逐渐增多，路由表也就越来越完备，数据转发的速度也会越来越快。我们需要注意的是：<br><br>1.重定向报文只能由路由器发出。<br><br>2.重定向报文为主机所用，而不是为路由器所用。 <br><br>在主机引导的时候，一般会发送在网内广播一个路由请求的ICMP报文，而多个路由器则会回应一个路由通告报文。而且，路由其本身不定期的在网络内发布路由通告报文，这样，根据这些报文，每一个主机都会有机会建立自己的路由表而实现网络通信。路由器在一份通告报文中可以通告多个地址，并且给出每一个地址的优先等级，这个优先等级是该IP作为默认路由的等级，至于怎么算的就不深究了。<br><br>路由器一般会在450-600秒的时间间隔内发布一次通告，而一个给定的通告报文的寿命是30分钟。而主机在引导的时候会每三秒发送一次请求报文，一旦接受到一个有效的通告报文，就停止发送请求报文。<br><br>在TCP/IP详解编写的时候，只有Solaris2.x支持这两种报文，大多数系统还不支持这两种报文。（后面还会讲到一些有用的路由报文）<br></p>
<h4 id="2-动态选路协议"><a href="#2-动态选路协议" class="headerlink" title="2.动态选路协议"></a>2.动态选路协议</h4><p>前面的选路方法叫做静态选路，简要地说就是在配置接口的时候，以默认的方式生成路由表项。并通过route来增加表项，或者通过ICMP报文来更新表项（通常在默认方式出错的情况下）。 而如果上诉三种方法都不能满足，那么我们就使用动态选路。<br><br>动态选路协议是用于动态选路的重要组成部分，但是他们只是使用在路由器之间，相邻路由器之间互相通信。系统（路有选择程序）选择比较合适的路有放到核心路由表中，然后系统就可以根据这个核心路有表找到最合适的网路。也就是说，动态选路是在系统核心网络外部进行的，它只是用一些选路的策略影响路由表，而不会影响到最后通过路由表选择路由的那一部分。选路协议有一大类常用的叫做内部网关协议(IGP)，而在IGP中，RIP就是其中最重要的协议。一种新的IGP协议叫做<code>开放最短路经优先(OSPF)协议</code>，其意在取代RIP。另一种最早用在网路骨干网上的IGP协议–HELLO，现在已经不用了。<br><br>如今，任何支持动态选路的路由器都必须同时支持OSPF和RIP，还可以选择性的支持其他的IGP协议。<br></p>
<h5 id="2-1-Unix选路程序"><a href="#2-1-Unix选路程序" class="headerlink" title="2.1.Unix选路程序"></a>2.1.Unix选路程序</h5><p>Unix系统上面通常都有路由守护程序－－routed。还有一个叫做gate。gate所支持的协议要比routed多，routed只是支持RIPv1版本。而gate则支持RIPv1、v2，BGPv1 等等。<br></p>
<h5 id="2-1-RIP：选路信息协议"><a href="#2-1-RIP：选路信息协议" class="headerlink" title="2.1.RIP：选路信息协议"></a>2.1.RIP：选路信息协议</h5><p>它的定义可以在RFC1058内找到，这种协议使用UDP作为载体（也就是UDP的上层协议）。我们最关心的就是RIP其中的一个段，叫做度量的段，这是一个以hop作为计数器（就是以走过多少路由为计数器）的段（IP协议里面也有一个TTL不是么）。这个度量段将最终影响到路由表的建立。参考图:<br><br>一般说来routed要承担如下的工作：<br><br>1.给每一个已知的路由器发送rip请求报文，要求其他路由器给出完整的路由表。这种报文的命令字段为1，地址字段为0，度量地段为16（相当于无穷大）。<br><br>2.接受请求，如果接收到刚才的那个请求，就把自己的完整的路由表交给请求者。如果没有，就处理IP请求表项，把表项中自己有的部分添上跳数，没有的部分添上16。然后发给请求者。<br><br>3.接受回应。更新自己的路由表。使用hop数小的规则。<br><br>4.定期更新路由表，一般是30s(真频繁)给相邻的路有启发一次自己的路由表。这种形式可以使广播形式的。<br><br>这个协议看起来会工作的很好，但是，这里面其实有很多隐藏的忧患，比如说RIP没有子网的概念，比如说环路的危险。而且hop数的上限也限制了网络的大小。<br><br>因此，出现了很多RIPv1的替代品，比如说RIPv2,比如说OSPF。他们都是通过某种策略来影响路由表，所以就不说了。<br></p>
<p>　</p>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/JS/" rel="tag">#JS</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/03/25/15/" rel="next" title="JS家的排序算法🎵">
                <i class="fa fa-chevron-left"></i> JS家的排序算法🎵
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/03/28/16/" rel="prev" title="本地存储小结💘">
                本地存储小结💘 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/03/25/14/"
           data-title="TCP/IP🌿" data-url="https://menggeniu.github.io/2016/03/25/14/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="menggeNIU" />
          <p class="site-author-name" itemprop="name">menggeNIU</p>
          <p class="site-description motion-element" itemprop="description">个人收藏</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">38</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/menggeNiu" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/1967072037" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://zjflove.github.io" title="zjf" target="_blank">zjf</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.901web.com" title="pybyongbo" target="_blank">pybyongbo</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-6"><a class="nav-link" href="#TCP-IP详解学习笔记-这位仁兄写得太好了"><span class="nav-number">1.</span> <span class="nav-text">TCP/IP详解学习笔记   这位仁兄写得太好了</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP-IP详解学习笔记-1-基本概念"><span class="nav-number"></span> <span class="nav-text">TCP/IP详解学习笔记(1)-基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#为什么会有TCP-IP协议"><span class="nav-number"></span> <span class="nav-text">为什么会有TCP/IP协议</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TCP-IP协议分层"><span class="nav-number"></span> <span class="nav-text">TCP/IP协议分层</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#一些基本的常识"><span class="nav-number"></span> <span class="nav-text">一些基本的常识</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#互联网地址-ip地址"><span class="nav-number"></span> <span class="nav-text">互联网地址(ip地址)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#域名系统"><span class="nav-number"></span> <span class="nav-text">域名系统</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#RFC"><span class="nav-number"></span> <span class="nav-text">RFC</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#端口号-port"><span class="nav-number"></span> <span class="nav-text">端口号(port)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#应用编程接口"><span class="nav-number"></span> <span class="nav-text">应用编程接口</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP-IP详解学习笔记-2-数据链路层"><span class="nav-number"></span> <span class="nav-text">TCP/IP详解学习笔记(2)-数据链路层</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#可见，RFC1042在TCP-IP里面处于一个配角的地位。这两种不同的数据报格式请参考教材。"><span class="nav-number">1.</span> <span class="nav-text">可见，RFC1042在TCP/IP里面处于一个配角的地位。这两种不同的数据报格式请参考教材。</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP-IP详解之IP协议ARP协议和RARP协议"><span class="nav-number"></span> <span class="nav-text">TCP/IP详解之IP协议ARP协议和RARP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-IP协议"><span class="nav-number"></span> <span class="nav-text">1.IP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-1-IP协议头"><span class="nav-number"></span> <span class="nav-text">1.1.IP协议头</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-2-IP路由选择"><span class="nav-number"></span> <span class="nav-text">1.2.IP路由选择</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-3-子网寻址"><span class="nav-number"></span> <span class="nav-text">1.3.子网寻址</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-ARP协议"><span class="nav-number"></span> <span class="nav-text">2. ARP协议</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP-IP详解学习笔记-4-ICMP协议，ping和Traceroute"><span class="nav-number"></span> <span class="nav-text">TCP/IP详解学习笔记(4)-ICMP协议，ping和Traceroute</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-IMCP协议介绍"><span class="nav-number"></span> <span class="nav-text">1.IMCP协议介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-ICMP的应用–ping"><span class="nav-number"></span> <span class="nav-text">2.ICMP的应用–ping</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-ICMP的应用–Traceroute"><span class="nav-number"></span> <span class="nav-text">3.ICMP的应用–Traceroute</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TCP-IP详解学习笔记-5-IP选路，动态选路，和一些细节"><span class="nav-number"></span> <span class="nav-text">TCP/IP详解学习笔记(5)-IP选路，动态选路，和一些细节</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-静态IP选路"><span class="nav-number"></span> <span class="nav-text">1.静态IP选路</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-1-一个简单的路由表"><span class="nav-number"></span> <span class="nav-text">1.1.一个简单的路由表</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-2-其他有关路由表的知识"><span class="nav-number"></span> <span class="nav-text">1.2.其他有关路由表的知识</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-3-ICMP的IP重定向报文和路由发现报文"><span class="nav-number"></span> <span class="nav-text">1.3.ICMP的IP重定向报文和路由发现报文</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-动态选路协议"><span class="nav-number"></span> <span class="nav-text">2.动态选路协议</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-Unix选路程序"><span class="nav-number"></span> <span class="nav-text">2.1.Unix选路程序</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-1-RIP：选路信息协议"><span class="nav-number"></span> <span class="nav-text">2.1.RIP：选路信息协议</span></a></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">menggeNIU</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"menggeniu"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  

  

  

</body>
</html>
